(function(e){e.fn.canvasLoader=function(t){function o(){for(i in n)n[i].draw()}var n=[],r={radius:20,color:"rgb(0,0,0)",dotRadius:2.5,backgroundColor:"transparent",className:"canvasLoader",id:"canvasLoader1",fps:10},s=e.extend(r,t);setInterval(o,1e3/s.fps);var u=function(e,t,n,r){this.ctx=e,this.radius=t,this.x=this.radius/2,this.y=this.radius/2,this.color=n,this.dotRadius=r,this.opacity=1,this.numDots=8,this.dots={},this.degrees=Math.PI*2/this.numDots;for(i=1;i<=this.numDots;i++)this.dots[i]=new a(Math.cos(this.degrees*i)*this.radius/Math.PI,Math.sin(this.degrees*i)*this.radius/Math.PI,this.dotRadius,this.color,i/this.numDots),this.dots[i].parent=this};u.prototype.draw=function(){this.ctx.clearRect(0,0,this.radius,this.radius),this.ctx.globalAlpha=1,this.ctx.fillStyle=s.backgroundColor,this.ctx.fillRect(0,0,this.radius,this.radius);for(i in this.dots)this.dots[i].changeOpacity(),this.dots[i].draw()};var a=function(e,t,n,r,i){this.radius=n,this.color=r,this.opacity=i,this.x=e,this.y=t};return a.prototype.draw=function(){this.parent.ctx.beginPath(),this.parent.ctx.globalAlpha=this.opacity,this.parent.ctx.fillStyle=this.color,this.parent.ctx.arc(this.x+this.parent.radius/2,this.y+this.parent.radius/2,this.radius,0,Math.PI*2,!0),this.parent.ctx.fill()},a.prototype.changeOpacity=function(){this.opacity-=1/this.parent.numDots,this.opacity<0&&(this.opacity=1)},e(this).each(function(){if(this.tagName=="IMG")e(this).load(function(){var r={radius:(e(this).width()+e(this).height())/2,dotRadius:(e(this).width()+e(this).height())/16,id:"canvasLoader"+(parseInt(e(".canvasLoader").size())+1)},i=e.extend(s,r,t),o=e("<canvas width='"+i.radius+"' height='"+i.radius+"' id='"+i.id+"' class='"+i.className+"'></canvas>"),a=o.get(0).getContext("2d");!a||(n[n.length+1]=new u(a,i.radius,i.color,i.dotRadius),e(this).replaceWith(o))});else{var r={radius:(e(this).width()+e(this).height())/2,dotRadius:(e(this).width()+e(this).height())/16,id:"canvasLoader"+(parseInt(e("."+s.className).size())+1)},i=e.extend(s,r,t),o=e("<canvas width='"+i.radius+"' height='"+i.radius+"' id='"+i.id+"' class='"+i.className+"'></canvas>"),a=o.get(0).getContext("2d");!a||(n[n.length+1]=new u(a,i.radius,i.color,i.dotRadius),e(this).replaceWith(o))}})}})(jQuery);