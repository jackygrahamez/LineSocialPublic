function autocheckout(){setInterval(function(){getLocation(1)},6e4)}function getLocation(e,t){lURL=t,$("ul.checkin").canvasLoader(),lineLength=e,navigator.geolocation?navigator.geolocation.getCurrentPosition(showPosition,showError):x.innerHTML="Geolocation is not supported by this browser."}function showPosition(e){var t=e.coords.latitude+","+e.coords.longitude;global_coords=[e.coords.latitude+","+e.coords.longitude],global_coords_lat=e.coords.latitude,global_coords_lon=e.coords.longitude;if(parseInt(lineLength)>1){var n=location.pathname+"/venues/";getVenues(n,t),$("#coords").val(e.coords.latitude+", "+e.coords.longitude),$("#line_length").val(lineLength)}else if(lineLength==1){var r=new Date,n=location.pathname+"/auto_checkout/";auto_checkout(n,e.coords.latitude,e.coords.longitude)}else getLines(lURL)}function showError(e){$("body > header p.invalid").length<1&&$("body > header").append("<p class='invalid'></p>"),$(".body > header p.invalid").length<1&&$(".body > header").append("<p class='invalid'></p>");switch(e.code){case e.PERMISSION_DENIED:$("header p.invalid").replaceWith("<p class='invalid'>Please enable location services for https://alpha.linesocial.mobi in your browser settings.</p>"),$(".loader").remove(),$("canvas").remove();break;case e.POSITION_UNAVAILABLE:$("header p.invalid").replaceWith("<p class='invalid'>Location information is unavailable.</p>"),$(".loader").remove(),$("canvas").remove();break;case e.TIMEOUT:$("header p.invalid").replaceWith("<p class='invalid'>The request to get user location timed out.</p>"),$(".loader").remove(),$("canvas").remove();break;case e.UNKNOWN_ERROR:$("header p.invalid").replaceWith("<p class='invalid'>An unknown error occurred.</p>"),$(".loader").remove(),$("canvas").remove()}}function getPage(e){$.ajax({url:e,type:"GET",cache:!1,success:function(t){markup=t,$("section.body.right").html(t),setTimeout(function(){$("section.body.right").addClass("active"),$("section.content").css("height","0px"),e==="#share"?($(".body.right.active").prepend("<div class='container hero-unit'><h2>Social Share</h2></div>"),$("html, body").animate({scrollTop:top-50},"slow"),$(".back.button").click(function(){$(".body").removeClass("active"),$("section.checkin").remove(),$("section.content").css("height","auto"),$("section.body.right").html("")})):$(".back.button").click(function(){$(".body").removeClass("active"),$("section.checkin").remove(),$("section.content").css("height","auto")})},1e3)},error:function(e,t,n){console.log("text status "+t+", err "+n)}})}function getNotifications(e){$.ajax({url:e,type:"GET",cache:!1,success:function(e){markup=e,$("body .body").last().after(e),setTimeout(function(){$(".back.button").click(function(){$("section.notifications").removeClass("active")})},1e3)},error:function(e,t,n){console.log("text status "+t+", err "+n)}})}function ArrNoDupe(e){var t={};for(var n=0;n<e.length;n++)t[e[n]]=!0;var r=[];for(var i in t)r.push(i);return r}function getVenues(e,t){var n=[];$(".checkin #wrapper > p").addClass("hide"),$.ajax({url:e,type:"POST",cache:!1,data:{coordinates:t},success:function(e){ajaxData=e,html="";for(var t=0;t<e.length;t++)typeof e[t].name!="undefined"&&(html+="<li><span>"+e[t].name+"</span></li>",n.push(e[t].name));$("#location").autocomplete({source:n}),$("form").removeClass("hide"),$("canvas").addClass("hide"),$("#checkin").click(function(e){var t=$("#location").val(),n=$("#coords").val(),r=$("#line_length").val(),i=$("form.checkin").attr("action");checkIn(t,n,r,global_coords_lat,global_coords_lon,i)}),$("input, textarea").focus(function(){$(this).css("color","black")})},error:function(e,t,n){console.log("text status "+t+", err "+n)}})}function updatePassword(e,t,n,r){r==""&&(r=" "),$.ajax({url:n,type:"POST",cache:!1,data:{id:e,password:t,telephone:r},success:function(e){e==="password updated!"&&$(".body .back").click()},error:function(e,t,n){console.log("text status "+t+", err "+n)}})}function userRegister(e,t,n,r,i,s){var o="/register";$.ajax({url:o,type:"POST",cache:!1,data:{email:e,password:t,firstName:n,lastName:r,username:i,telephone:s},success:function(e){e=="Account was created"?location.replace(location.origin):$("form > p").first().replaceWith(e)},error:function(e,t,n){console.log("text status "+t+", err "+n)}})}function regCheck(e){var t="/register_value";$.ajax({url:t,type:"POST",cache:!1,data:{username:e},success:function(e){e=="username taken"?$("input[name='username']").addClass("invalid"):$("input[name='username']").removeClass("invalid")},error:function(e,t,n){console.log("text status "+t+", err "+n)}})}function grantPoints(e,t){var n="/grant_points";$.ajax({url:n,type:"POST",cache:!1,data:{cID:e,user_id:t},success:function(e){},error:function(e,t,n){console.log("text status "+t+", err "+n)}})}function sendPoints(e,t,n){var r="/send_points";$.ajax({url:r,type:"POST",cache:!1,data:{points:n,fID:e,tID:t},success:function(e){},error:function(e,t,n){console.log("text status "+t+", err "+n)}})}function regCheckEmail(e){var t="/register_email_value";$.ajax({url:t,type:"POST",cache:!1,data:{email:e},success:function(e){e=="email taken"?$("input[name='email']").addClass("invalid"):$("input[name='email']").removeClass("invalid")},error:function(e,t,n){console.log("text status "+t+", err "+n)}})}function isValidEmail(e){var t=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);return t.test(e)}function updateMessages(e,t,n,r,i,s,o,u){$.ajax({url:u,type:"POST",cache:!1,data:{ts:e,cID:t,fID:n,tID:r,user:s,messages:i,tester:o},success:function(e){},error:function(e,t,n){console.log("text status "+t+", err "+n)}})}function updateNotificationMessages(e,t,n,r,i){$.ajax({url:r,type:"POST",cache:!1,data:{cID:e,fID:t,messages:n,requests:i},success:function(e){},error:function(e,t,n){console.log("text status "+t+", err "+n)}})}function getMessages(e,t,n,r,i){$.ajax({url:i,type:"POST",cache:!1,data:{cID:e,fID:t,tester:n,session_id:r},success:function(e){markup=e,$("section.body.right").html(e),setTimeout(function(){$("section.body.right").addClass("active"),$(".back.button").click(function(){$(".body").removeClass("active"),$("section.checkin").remove()})},1e3)},error:function(e,t,n){console.log("text status "+t+", err "+n)}})}function checkTime(e){return e<10&&(e="0"+e),e}function checkIn(e,t,n,r,i,s){e.length>0&&t.length>0&&n.length>0&&$.ajax({url:s,type:"POST",cache:!1,data:{location:e,geolocation:t,line_length:n,lat:r,lon:i},success:function(e){markup=e,$("#demo").html(e),global_cID=e,autocheckout(),$(".checkin.active .back").click(),$(".line_pokes > div").remove(),$(".chat_requests > ul > li").remove()},error:function(e,t,n){console.log("text status "+t+", err "+n)}})}function auto_checkout(e,t,n){t&&$.ajax({url:e,type:"POST",cache:!1,data:{lat:t,lon:n},success:function(e){markup=e;if(e==="checkout"){var t=window.setInterval("",9999);for(var n=1;n<t;n++)window.clearInterval(n)}},error:function(e,t,n){}})}function captchaPoints(e,t){$.ajax({url:t,type:"POST",cache:!1,data:{_points:e},success:function(e){markup=e,$("section.body.right").html(e),setTimeout(function(){$("section.body.right").addClass("active"),$("section.content").css("height","0px"),$(".back.button").click(function(){$(".body").removeClass("active"),$("section.checkin").remove(),$("section.content").css("height","auto")})},1e3)},error:function(e,t,n){console.log("text status "+t+", err "+n)}})}function codeValidate(e,t){$.ajax({url:t,type:"POST",cache:!1,data:{code:e},success:function(e){markup=e,$("section.body.right").html(e),setTimeout(function(){$("section.body.right").addClass("active"),$("section.content").css("height","0px"),$(".back.button").click(function(){$(".body").removeClass("active"),$("section.checkin").remove(),$("section.content").css("height","auto")})},1e3)},error:function(e,t,n){console.log("text status "+t+", err "+n)}})}function getLines(e){typeof global_coords_lat!="undefined"&&typeof global_coords_lon!="undefined"?setTimeout(function(){$.ajax({url:e,type:"POST",cache:!1,data:{lat:global_coords_lat,lon:global_coords_lon},success:function(e){e!=null?($("section.body.right").html(e),$("section.notifications").hasClass("active")||$("section.notifications").addClass("hide"),setTimeout(function(){$("body > .loader").remove(),$("section.body.right").addClass("active"),$(".back.button").click(function(){$(".body").removeClass("active"),$("section.checkin").remove(),$("section.notifications").removeClass("hide")})},1e3)):($("body > header p.invalid").length<1&&$("body > header").append("<p class='invalid'></p>"),$(".body > header p.invalid").length<1&&$(".body > header").append("<p class='invalid'></p>"),$("header p.invalid").replaceWith("<p class='invalid'>Network Connection Problem</p>"),$(".loader").remove(),$("canvas").remove())},error:function(e,t,n){console.log("text status "+t+", err "+n),$("body > header p.invalid").length<1&&$("body > header").append("<p class='invalid'></p>"),$(".body > header p.invalid").length<1&&$(".body > header").append("<p class='invalid'></p>"),$("header p.invalid").replaceWith("<p class='invalid'>Network Connection Problem</p>"),$(".loader").remove(),$("canvas").remove()},timeout:1e4,async:!1})},100):setTimeout(function(){$.ajax({url:e,type:"POST",cache:!1,data:{lat:"",lon:""},success:function(e){e!=null?($("section.body.right").html(e),setTimeout(function(){$("section.body.right").addClass("active"),$(".back.button").click(function(){$(".body").removeClass("active"),$("section.checkin").remove()})},1e3)):($("body > header p.invalid").length<1&&$("body > header").append("<p class='invalid'></p>"),$(".body > header p.invalid").length<1&&$(".body > header").append("<p class='invalid'></p>"),$("header p.invalid").replaceWith("<p class='invalid'>Network Connection Problem</p>"),$(".loader").remove(),$("canvas").remove())},error:function(e,t,n){console.log("text status "+t+", err "+n)},timeout:1e4,async:!1})},100)}function deviceType(e){var t=navigator.userAgent,n={iphone:t.match(/(iPhone|iPod|iPad)/),windows_phone:t.match(/IEMobile/),android:t.match(/Android/)};n.android?$("html").addClass("android"):n.iphone?($("html").addClass("iphone"),e()):n.blackberry?$("html").addClass("blackberry"):n.windows_phone&&$("html").addClass("IEMobile")}function iosCheckbox(){$(".on_off :checkbox").iphoneStyle(),$(".disabled :checkbox").iphoneStyle(),$(".css_sized_container :checkbox").iphoneStyle({resizeContainer:!1,resizeHandle:!1}),$(".long_tiny :checkbox").iphoneStyle({checkedLabel:"Very Long Text",uncheckedLabel:"Tiny"});var e=$(".onchange :checkbox").iphoneStyle({onChange:function(e,t){$("span#status").html(t.toString())}})}function getURLParameter(e){return decodeURIComponent(((new RegExp("[?|&]"+e+"="+"([^&;]+?)(&|#|;|$)")).exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}var x=document.getElementById("demo"),lineLength=0,global_coords="",global_cID="",global_fID="",global_tID="",html,ajaxData,lURL;(function(e,t,n){var r=null,i=null,s=getURLParameter("email_validation"),o=getURLParameter("telephone_validation");s&&codeValidate(s,"/send_validate_email_code"),o&&codeValidate(o,"/send_validate_phone_code");try{i=location.pathname,r=getURLParameter("pagename")}catch(u){console.log("could not find parameter pagename")}deviceType(iosCheckbox),e("input, textarea").focus(function(){e(this).css("color","black")}),e("a").click(function(t){t.preventDefault(),e("#captcha").remove(),e(".footer li.expanded").removeClass("expanded");var n=e(this).attr("href");if(n!="")if(n.indexOf("notifications")>0)e(".notifications").addClass("active");else if(n.indexOf("user_lines")>0){e("html, body").animate({scrollTop:top-50},"slow");var r='<div class="loader" style="position: fixed;height: 100%;width: 100%;top: 40px;left: 0px;background: rgba(0,0,0, 0.2);"><div></div></div>';e("body > canvas").length<1&&(e("body").append(r),e(".loader > div").canvasLoader(),console.log("url "+n),getLocation(0,n))}else e(this).parent().parent().parent().hasClass("addthis")?(console.log("url "+n),n="#share",getPage(n),setTimeout(function(){e("section header .back.button").addClass("active")},1e3)):e(this).hasClass("facebook")?location.assign(n):e(this).hasClass("logout")?location.assign(n):(console.log("get URL "+n),getPage(n));else location.assign(n)}),e(".back.button").click(function(){e(".body").last().removeClass("active"),e(".checkin").remove()}),e(".register input").focusout(function(){var t=e(this);t.val().length>0&&t.removeClass("invalid")}),e(".register input[name='username']").focusout(function(){var t=e(this).val();t.length>0&&regCheck(t)}),e(".register input[name='email']").focusout(function(){var t=e(this).val();if(t.length>0){var n={email:t};regCheckEmail(t)}}),e("input[name='terms']").click(function(){e(this).removeClass("invalid"),e("form label").removeClass("invalid")}),t.location.href.indexOf("#_=_")>0&&(t.location=t.location.href.replace(/#.*/,"")),e("menu.footer li").click(function(){if(!e(this).hasClass("expanded")){var t=e(this).next();if(e(t).hasClass("expanded"))e(this).removeClass("down"),e(t).removeClass("expanded");else{e(".down").removeClass("down"),e(".expanded").removeClass("expanded"),e(this).addClass("down"),e(t).addClass("expanded");var n=e(t).position().top;e("html, body").animate({scrollTop:n-50},"slow")}}}),e("menu.themes li").click(function(){e(this).siblings().removeClass("active"),e(this).addClass("active");var t=e(this).attr("rel");setActiveStyleSheet(t)}),e("menu.themes > li").first().addClass("active"),e("link").each(function(){if(!e(this).attr("disabled")&&e(this).attr("title")!=n){var t=e(this).attr("title");e(".themes li[rel='"+t+"']").click()}}),e("input[name='telephone']").intlTelInput(),setTimeout(function(){e(".overlay").hide(),r==="user_notifications"&&e("a[href$='user_notifications/']").click()},5e3),e(".forgot_password div.back.button, .forgot div.back.button").click(function(){location.assign("/")}),e("html").removeClass("disabled")})(jQuery,this),define("main",function(){});