function notificationsModule(){var e=$(".message_from").attr("value");global_tID="";var t=[],n=io.connect(location.origin),i=($(".field.notfications"),$(".send.notifications"),$(".content.notifications"),$(".send.notifications")),r=!1;$(".notifications.controls .cID").val(global_cID),$(".notifications.controls .tID").val(global_tID),global_cID=$(".notifications.controls .cID").val(),global_fID=$(".notifications.controls .fID").val();var a=$(".chat_requests ul li").length;if(parseInt(a)>0&&$(".line_pokes div").text(a),$(".notifications.content div").length>0&&$(".chat_requests > ul > li").length<1){var o=[];$(".notifications.content div").each(function(){$(this).attr("fid")!=$(".notifications.fid").attr("value")&&$(this).attr("name")!=$(".name.notifications").attr("value")&&o.push($(this).attr("name")+"_"+$(this).attr("fid"))});var s=ArrNoDupe(o),c="";if(s.length>0){$(".line_pokes div").replaceWith("<div>"+s.length+"</div>");for(var l=0;l<s.length;l++){var u=s[l].split("_").pop();s[l].split("_").pop(),c+='<li ufid="'+u+'">'+e+" "+s[l].split("_")[0]+"</li>"}$(".chat_requests ul").html(c)}else $(".line_pokes div").addClass("hide")}n.on("message",function(e){if(e.message){t.push(e);var a=$(".content.notifications").html(),o="",s=[],c="bubbledLeft";global_cID=$(".notifications.controls .cID").attr("value"),global_fID=$(".notifications.controls .fID").attr("value"),global_tID=$(".notifications.controls .tID").attr("value"),n.emit("newUser",global_fID);for(var l=0;l<t.length;l++)if($(".notifications.controls .cID").attr("value")==t[l].cID&&"undefined"!=typeof t[l].username){if($(".content.notifications div").each(function(){$(this).attr("ts")==t[l].ts&&(r=!0)}),$(".chat_requests ul li").each(function(){$(this).attr("ufid")==t[l].ts&&(r=!0)}),!r){t[l].fID!=$(".notifications.controls .fID").attr("value")&&s.push(t[l].username+"_"+t[l].fID),t[l].fID===$(".fID.notifications").attr("value")&&(c="bubbledRight");var u=new Date,d=u.getHours(),f="am";d>12&&(d-=12,f="pm");var p=u.getMinutes();p=checkTime(p);var h=" "+d+":"+p+" "+f;a+='<div ts="'+t[l].ts+'" class="'+c+'" name="'+t[l].username+'" cID="'+t[l].cID+'" fID="'+t[l].fID+'" tID="'+t[l].tID+'"><span><b>'+(t[l].username?t[l].username:"Server")+": </b>",a+=t[l].message+" <time>"+h+"</time></span></div>"}r=!1}var g=ArrNoDupe(s);a.length>0&&($(".content.notifications").html(a),$(".content.notifications").stop().animate({scrollTop:$(".content.notifications")[0].scrollHeight},800)),g.length>0?$(".line_pokes div").replaceWith("<div>"+g.length+"</div>"):$(".line_pokes div").addClass("hide"),global_tID&&$(".accordion .content.notifications p").each(function(){$(this).attr("fid")==global_tID||$(this).attr("tid")==global_tID?$(this).show():$(this).hide()});for(var o=$(".chat_requests ul").html(),l=0;l<g.length;l++){var m=g[l].split("_").pop();g[l].split("_").pop(),m!=$(".notifications.fid").attr("value")&&$(".chat_requests ul li[ufid='"+m+"']").length<1&&(o+='<li ufid="'+m+'">Message from '+g[l].split("_")[0]+"</li>",$(".chat_requests ul").append(o),$(".chat_requests ul > li").unbind("click"),$(".chat_requests ul > li").click(function(){var e=$(this).attr("ufid");global_tID=e,$(".notifications.controls .tID").attr("value",global_tID),$(".accordion").toggleClass("off"),$(".accordion div").hide(),$(".accordion ."+e).show(),$(".content.notifications").stop().animate({scrollTop:$(".content.notifications")[0].scrollHeight},800),$(".accordion .content.notifications div").each(function(){$(this).attr("fid")==global_tID||$(this).attr("tid")==global_tID?$(this).show():$(this).hide()});$(".content").html(),$(".chat_requests > ul ").html(),"/"+i.value+"/update_notification_messages/";global_fID=$(".message.controls .fID").attr("value"),global_cID=$(".message.controls .cID").attr("value")}))}o.length>0&&$(".chat_requests ul").html(o),$(".chat_requests ul li").click(function(){var e=$(this).attr("ufid");global_tID=e,$(".notifications.controls .tID").attr("value",global_tID),$(".accordion").toggleClass("off"),$(".accordion ."+e).show(),$(".content.notifications").stop().animate({scrollTop:$(".content.notifications")[0].scrollHeight},800),$(".accordion .content.notifications div").each(function(){$(this).attr("fid")==global_tID||$(this).attr("tid")==global_tID?$(this).show():$(this).hide()})})}else console.log("There is a problem:",e)}),$(".send.notifications").click(function(){var e=new Date;if(""==i.value)alert("Please type your name!");else{var e=new Date,t=e.getHours(),r="am";t>12&&(t-=12,r="pm");var a=e.getMinutes();a=checkTime(a);var o=$(".field.notifications").val(),s=e.getTime(),c=$(".name.notifications").val();html="";var l=$(".notifications.controls .tID").attr("value"),u=$(".notifications.controls .cID").attr("value"),d=$(".notifications.controls .fID").attr("value");n.emit("send",{ts:s,cID:u,fID:d,tID:l,message:o,username:c});var f="/"+i.value+"/update_messages/";updateMessages(s,u,d,l,o,c,f),$(".field.notifications").val(""),o=""}})}